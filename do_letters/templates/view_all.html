{% extends 'C:\Users\Administrator\Documents\devMISI\inspects\templates\base.html' %} 
<!--{% for i in profiles %}
    <p>{{i}}</p>
    <br>
{% endfor %}-->


{% load static %}
{% block content %}
<head>
  <script type="text/javascript" src="js/jquery.min.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script src="//code.jquery.com/jquery.min.js"></script>
  <!-- <link rel="stylesheet" href="jquery.dropdown.css"> -->
  <script src="jquery.dropdown.js"></script>
  <!-- Include the plugin's CSS and JS: -->
  
  <script type="text/javascript" src="js/bootstrap-multiselect.js"></script>
  <link rel="stylesheet" href="css/bootstrap-multiselect.css" type="text/css"/>
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  
  <link rel="stylesheet" type="text" href="{% static '/bootstrap-5.1.3-dist/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" media="screen" href="{% static '/css/bootstrap.min.css' %}">
  
  <link href="{% static '/css/bootstrap-toggle.min.css' %}" rel="stylesheet">
  <script src="{% static '/js/bootstrap-toggle.min.js' %}"></script>
  
      <link rel="stylesheet" type="text/css" href="{% static '/css/select2.min.css' %}" />
      <link rel="stylesheet" type="text/css" media="screen" href="{% static '/css/select2.min.css' %}">
  <link rel="stylesheet" href="{% static '/css/jquery-ui.css' %}">
  
  
  <link rel="stylesheet" href="{% static '/css/font-awesome.min.css' %}">
  
  <script src="{% static 'js/timepicker.js' %}"></script>
  <!-- <link rel="stylesheet" type="text/css" href="{% static '/css/select2.min.css' %}" /> -->
  
    <script src="{% static '/js/jquery.min.js' %}"></script>
     <!-- Select2 CSS --> 
  
  <!-- jQuery --> <script src="{% static '/js/jquery.min4.js' %}"></script> 
  
  <!-- Select2 JS --> 
  <script src="{% static '/js/select2.min.js' %}"></script>
  <!-- Load icon library -->
  <link rel="stylesheet" href="{% static '/css/font-awesome.min.css' %}">
  <!-- multiple selesct marked officer -->
  
  <link href="css/jquery.multiselect.css" rel="stylesheet" type="text/css">
  <script src="{% static '/js/jquery.dataTables.min.js' %}"></script>
    <link href="{% static '/css/jquery.dataTables.min.css' %}"  rel="stylesheet"/>
    <!-- Sheets for datepicker for target date -->
    
    <link rel="stylesheet" href="{% static '/css/jquery-ui.css' %}">
    <link rel="stylesheet" href="/resources/demos/style.css">
    <script src="{% static '/js/jquery-ui.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static '/css/quicksand.css' %} ">
    <link rel="stylesheet" type="text/css" href="{% static '/css/lato.css' %} ">
    <link href="{% static 'css/roboto.css' %}" rel="stylesheet"><br>


    <script type="text/javascript" src="{% static '/daterangepicker-master/moment.min.js'%}"></script>
   <script type="text/javascript" src="{% static '/daterangepicker-master/daterangepicker.js'%}"></script>
  <link rel="stylesheet" type="text/css" href="{%static '/daterangepicker-master/daterangepicker.css'%}" />


    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta3/js/bootstrap-select.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
    
  
  <style>
    * {
    box-sizing: border-box;
  }
  body {
          font-family: 'Quicksand', sans-serif;;
          height: 100%;
          margin: 0;
          }
  
  
      
        input[type=text]
        {
                width: 100%;
                padding: 12px 20px;
                margin: 8px 0;
                display: block;
                /* border: 1.5px solid rgb(14, 12, 12); */
                border-radius: 4px;
                box-sizing: border-box;
        }
      
        input[type=submit] {
                width: 40%;
                text-align: center;
                background-color: #4CAF50;
               
                padding: 14px 20px;
                margin: 8px 0;
                border: none;
                border-radius: 4px;
                cursor: pointer;
        }
      
        input[type=submit]:hover {
                background-color: #45a049;
                text-align: center;
        }
      
      
        input[type=button]:hover {
                background-color: #45a049;
                text-align: center;
        }
        /* #viewbtn{
          margin-left:1050px;
        } */
      
        .inputtag{
          height:20px;
        }
        .button {
    padding: 15px 25px;
    font-size: 12px;
    text-align: center;
    margin-left: 2em;
    cursor: pointer;
    outline: none;
    color: #fff;
    background-color: #04AA6D;
    border: none;
    border-radius: 15px;
   
  }
  
  .button:hover {background-color: #3e8e41}
  
  .button:active {
    background-color: #3e8e41;
    box-shadow: 0 5px #666;
    transform: translateY(4px);
  }
      </style>
      
    
</head>
<body>
  
  <div class="row">
    <div class="col-4"></div>
    <div class="col-4"><h3 style="font-family: 'Lato', sans-serif;">
      <center><b>D.O. Letters Created by me</b></center>
    </h3></div>
    <div class="col-4"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#upload_modal">
      Upload D.O. Letter
    </button></div>
    
    
  </div>
    <div class="container-fluid">
     <div class="row ">
        <div class="col" style="overflow: auto;">
          <!-- <center style="background-color: grey;"><h4>D.O Letters</h4></center> -->
            <table class="table table-striped table-bordered table-sm" id="table_id" style="width: 100%" >
                <thead
                    style="background-color: #343a40;white-space: nowrap; color:white;text-align: left;">
                    <th style="width: 3%;"> S.No.</th>
                    <th style="width: 8%;">D.O. Date</th>
                    <th style="width: 15%;">D.O. Letter No.</th>
                    <th style="width: 7%;">Marked To</th>
                    <th style="width: 7%;">Reply Status</th>
                    <th style="width: 8%;">Reply Date</th>
                    <th style="width: 50%;">Remarks</th>
                    <th style="width: 2%;">Attachment</th>  
                  </thead>
            <tbody>
            <!-- jinja2 Technique -->
            {% if letters %}  
            {% for i in letters  %}
              <tr>
                <td style="width: 3%;"> {{forloop.counter}}</td>
                <td style="width: 8%;">{{i.do_letter_date | date:'d-m-Y' }}</td>
                <td style="width: 15%;"><a href="{% url 'reply_status' i.id %}" return false;> {{i.do_letter_no}}</a></td>
                <td style="width: 7%;">{{i.desig_id}}</td>
                {% if i.status_flag == 'Pending' %}
                <td style="width: 7%; color: red;">{{i.status_flag}}</td>
                <td style="width: 8%;">{{i.date_of_reply | date:'d-m-Y' }}</td>
                <td style="width: 50%;">{{i.remarks}}</td>
                <td style="width: 2%;"></td>  
                {% else %}
                <td style="width: 7%; color: green;">{{i.status_flag}}</td>
                <td style="width: 8%;">{{i.date_of_reply | date:'d-m-Y' }}</td>
                <td style="width: 50%;">{{i.remarks}}</td>
                <td style="width: 2%;"><i class="fa fa-paperclip" aria-hidden="true"></i></td>
                {% endif %}
 
            </tr>
            {% endfor %}
            {% endif %}
            </tbody>
          </table>
        </div> <!--end table div-->
        
        <!-- <div class="col-6">
          <center style="background-color: grey;"><h4>D.O Letters</h4></center>

          <div hidden id="view2" style="padding: 10%;">
            <table border="1" align="center" >
              
              <th style="font-size: 20px; color: red; height: 10%;">click on the D.O. Letter No. for more information</th>
              
              <h5></h5>
            </table> 
          </div>

          <div id="view1">
            <ul class="nav nav-tabs">
              <li class="nav-item">
                <a class="nav-link active" href="#incoming">Details</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">History</a>
              </li>
            </ul>
            <div class="tab-content">
              <div id="incoming" class="container-fluid tab-pane active table-responsive">
                <div class="row m-1 mt-2" style="color: red;"><h5 style="font-family: copperplate;">D.O. Letter No : </h5></div>
                <div class="row m-1" style="color: blue;"><h5 style="font-family: copperplate;">D.O. Letter Date : </h5> </div>
                <div class="row m-1" style="color:blue"><h5 style="font-family: copperplate;">Subject : </h5></div>
                <div>#####DO letter Preview####</div>
               </div>
              </div>
            </div>
          </div>
          
        </div>-->
        <!-- UPLOAD MODAL WINDOW -->
        
        
        
        <!-- Modal -->
        <div class="modal fade" id="upload_modal" tabindex="-1" role="dialog" aria-labelledby="uploadModal" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Upload D.O. Letter</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                  <div class="row">                      
                      <div class="col" style="background-color: white;">
                        <form action="" method="POST" class="was-validated" enctype="multipart/form-data">
                          {% csrf_token %}
                              <div class="row ">
                                  
                                  <div class="col-md-5 " style="padding-top: 3%;" >
                                      <label for ='do_letter_no' class="mr-sm-2">DO Letter No.</label> 
                                  </div>
                                   
                                  <div class="col-md-5" >
                                      <input type ='text' class="form-control mb-2 mr-sm-2" name="do_letter_no" placeholder="Enter Letter No." required>
                                  </div>
                              </div>
                              <div class="row">
                                  <div class="col-md-5" >
                                      <label for ='date' class="mr-sm-2">DO Letter Date</label> 
                                  </div>
                                  <div class="col-md-5" >
                                      <input type="date" class="form-control mb-2 mr-sm-2" name="date" placeholder="Select Date" id="email" required>
                                  </div>
                              </div>
                              <div class="row">
                                  <div class="col-md-5" >
                                      <label for ='subject' class="mr-sm-2">Subject</label>
                                  </div>
                                  <div class="col-md-5" >
                                      <textarea class="form-control mb-2 mr-sm-2" name="subject" placeholder="Enter Subject" required></textarea>
                                  </div>
                              </div>
                              <div class="row">
                                  <div class="col-md-5" >
                                      <label for ='action_by' class="mr-sm-2">Action By</label>
                                  </div>
                                  <div class="col-md-5" >
                                    
                                     
                                      <!-- <select id="desig" name="desig" placeholder="--Select--" required style="height: 35px; width:180px">
                                    
                                        <option value="" selected disabled hidden>--Select--</option>
                                          {% for i in officers %}
                                          <option value="{{i.designation}}">{{i.designation}}</option>
                                          {% endfor %}
                                      </select>  -->
                                      <div class="multi_select_box" >
                                      <input type="text" id="action_by_test" name="action_by_test" hidden>
                                        <select id="action_by" name="action_by" class="form-control" style="width: 180px;"  data-live-search="true" multiple data-actions-box="true" multiple data-selected-text-format="count > 2" multiple>
                                           
                                              {% for i in officers %}
                                              <option style="width:20px" value="{{i.designation}}" data-tokens="{{i.designation}}">{{i.designation}}</option>
                                              {% endfor %}
                    
                                        </select>
                                        <!-- <input type="button" id="desgnbtn${item}" value="Ok" onclick="getOption('desgn${item}')">
                                        <input type="text" id="desgninp${item}" value="" hidden> -->
                    
                                      </div>
                                     
                                  </div>
                              </div>
                              <div class="row mt-2">
                                  <div class="col-md-5" >
                                      <label for ='do_pdf' class="mr-sm-2">Upload DO letter</label>
                                  </div>
                                  <div class="col-md-5" >
                                      <input name="do_file" type="file" accept="application/pdf, image/jpeg, image/x-png, " style="width: 100%;" />
                                      <p style="color: blue;">Accepted types: .pdf, .png, .jpeg, .jpg</p>
                                  </div>
                              </div>
                             <div class="row">
                              <div class="col-2 mr-3">
                                  <button type="submit" id="submit" class="btn btn-primary mb-2 mt-4">Submit</button> 
                              </div>
                             </div>
                          </form>
                         
                      </div>
                  </div>
                
              </div>
              <!-- <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
              </div> -->
            </div>
          </div>
        </div>

     </div> 
    </div> 

    <script>
      $('#action_by').select2()

      $(document).ready(function() {
        $('#submit').click(function() {
            var selected = $("#action_by :selected").map((_, e) => e.value).get();
            document.getElementById('action_by_test').value=selected;
            //alert(document.getElementById('action_by_test').value)

            
        });
    });

      $(document).ready( function () {
        
        $('#table_id').DataTable();
    } );

     function upload_do(){
          
          data={
            csrfmiddlewaretoken:'{{csrf_token}}'
          };
          $.ajax
          ({
              url: "{% url 'upload-do' %}",
              method: "POST",
              dataType: "JSON",
              async: false,
              data: data,
              success: function (response) 
              {
                let row='';
                row+='<option selected disabled hidden value=""> Select To Mark</option>';
                for (let i=0; i<response.length;i++)
                {
                  row+='<option value=">'+response[i].designation+'">'+response[i].designation+'</option>';
                  console.log(response[i]);
                }
                
              $('#desig').append(row);
              }
          });
          
        }

        

    </script>
    </body>
{% endblock %}