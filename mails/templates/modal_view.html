{% extends 'C:\Users\Administrator\Documents\devMISI\inspects\templates\base.html' %}
<!--{% for i in profiles %}
    <p>{{i}}</p>
    <br>
{% endfor %}-->


{% block content %}
<head>
  <meta http-equiv="Content-Security-Policy"
      content="default-src 'self'; pdf-src https://*; img-src https://*; child-src 'none';">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css">
  <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
  <style>
    * {
    box-sizing: border-box;
  }
  body {
          font-family: 'Quicksand', sans-serif;;
          height: 100%;
          margin: 0;
          }
  
  
      
        input[type=text]
        {
                width: 100%;
                padding: 12px 20px;
                margin: 8px 0;
                display: block;
                /* border: 1.5px solid rgb(14, 12, 12); */
                border-radius: 4px;
                box-sizing: border-box;
        }
      
        input[type=submit] {
                width: 40%;
                text-align: center;
                background-color: #4CAF50;
               
                padding: 14px 20px;
                margin: 8px 0;
                border: none;
                border-radius: 4px;
                cursor: pointer;
        }
      
        input[type=submit]:hover {
                background-color: #45a049;
                text-align: center;
        }
      
      
        input[type=button]:hover {
                background-color: #45a049;
                text-align: center;
        }
        /* #viewbtn{
          margin-left:1050px;
        } */
      
        .inputtag{
          height:20px;
        }
        .button {
    padding: 15px 25px;
    font-size: 12px;
    text-align: center;
    margin-left: 2em;
    cursor: pointer;
    outline: none;
    color: #fff;
    background-color: #04AA6D;
    border: none;
    border-radius: 15px;
   
  }
  
  .button:hover {background-color: #3e8e41}
  
  .button:active {
    background-color: #3e8e41;
    box-shadow: 0 5px #666;
    transform: translateY(4px);
  }
      </style>
      
    
</head>
<body>
  <h3 style="font-family: 'Lato', sans-serif;">
    <center><b>D.O. Letters Created by me</b></center>
  </h3>
    <div class="container-fluid">
     <div class="row ">
        <div class="col-6" style="overflow: auto;">
          <center style="background-color: grey;"><h4>D.O Letters</h4></center>
            <table class="table table-striped table-bordered table-sm" id="table_id" style="width: 100%" >
                <thead
                    style="background-color: #343a40;white-space: nowrap; color:white;text-align: left;">
                    <th style="width: 3%;"> S.No.</th>
                    <th style="width: 8%;">D.O. Date</th>
                    <th style="width: 15%;">D.O. Letter No.</th>
                    <th style="width: 7%;">Marked To</th>
                    <th style="width: 7%;">Reply Status</th>
                    <!-- <th style="width: 8%;">Reply Date</th>
                    <th style="width: 50%;">Remarks</th>
                    <th style="width: 2%;">Attachment</th>   -->
                  </thead>
            <tbody>
            <!-- jinja2 Technique -->
            {% if letters %}  
            {% for i in letters  %}
              <tr>
                <td style="width: 3%;"> {{forloop.counter}}</td>
                <td style="width: 8%;">{{i.do_letter_date | date:'d-m-Y' }}</td>
                <td style="width: 15%;"><a href="" onclick="open_do('{{i.id}}'); return false";> {{i.do_letter_no}}</a></td>
                <td style="width: 7%;">{{i.desig_id}}</td>
                <td style="width: 7%;">{{i.status_flag}}</td>
                <!-- <td style="width: 8%;">{{i.date_of_reply | date:'d-m-Y' }}</td>
                <td style="width: 50%;">{{i.remarks}}</td>
                <td style="width: 2%;"><i class="fa fa-paperclip" aria-hidden="true"></i></td>   -->
            </tr>
            {% endfor %}
            {% endif %}
            </tbody>
          </table>
        </div> <!--end table div-->
        
        <div class="col-6">
          <center style="background-color: grey;"><h4>D.O Letters</h4></center>

          <div hidden id="view2" style="padding: 10%;">
            <table border="1" align="center" >
              
              <th style="font-size: 20px; color: red; height: 10%;">click on the D.O. Letter No. for more information</th>
              
              <h5></h5>
            </table> 
          </div>

          <div id="view1">
            <ul class="nav nav-tabs nav-fill mb-2">
              <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#details">Details</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#history" >History</a>
              </li>
            </ul>

            <div class="tab-content">
              <div id="details" class="container-fluid tab-pane active">
                <div class="row">
                    <div class="col-4 mt-3"><h5 style="font-family: copperplate; color: red;">D.O. Letter No : </h5></div> 
                    <div class="col-6"><input type="text" value=""  id="letter_no" readonly class="form-control" /></div>  
                </div>
                <div class="row">
                    <div class="col-4 mt-3"><h5 style="font-family: copperplate; color: blue;">D.O. Letter Date : </h5></div> 
                    <div class="col-6"><input type="text" value=""  id="letter_date" readonly class="form-control" /></div>  
                </div>
                <div class="row">
                    <div class="col-4 mt-3"><h5 style="font-family: copperplate; color: blue;">Subject: </h5></div> 
                    <div class="col-6"><textarea value=""  id="subject" readonly class="form-control" width="100%"></textarea></div>  
                </div>
                    <div class="rectangle m-3" id="preiew_div" style="height: 350px;">
                      <!-- <a id="preview">hello</a> -->
                      <!-- <object data="/media/do_letter/326ASE.pdf" type="application/pdf">
                        <embed src="/media/do_letter/326ASE.pdf"  type="application/pdf"/>
                      </object> -->
                      <!-- <embed id="preview" height="50%" width="100%"/> -->
                      <!-- <iframe Content-Security-Policy: frame-ancestors 'self' src="/media/do_letter/326ASE.pdf" id="preview"> </iframe> -->

                      <!-- <iframe src="https://docs.google.com/viewerng/viewer?url=http://infolab.stanford.edu/pub/papers/google.pdf&embedded=true" frameborder="0" height="100%" width="100%">
                      </iframe> -->
                      <!-- <embed type="application/x-google-chrome-pdf" src="" original-url="http://127.0.0.1:8000/media/do_letter/326ASE.pdf" javascript="allow"> -->
                    </div>
              </div>
              
            
            
                <div id="history" class="container-fluid tab-pane table responsive" >
                    <table class="table table-striped table-bordered table-sm mt-4" id="modal_table" style="width: 100%; " >
                        <thead
                            style="background-color: #343a40;white-space: nowrap; color:white;text-align: left;">
                             <th style="width: 15%;">Reply Date</th>
                             <th style="width: 80%;">Remarks</th>
                             <th style="width: 5%;">Attachment</th>  
                        </thead>
                        <tbody>
                          <!-- jinja2 Technique -->
                          <!-- {% if letters %}  
                          {% for i in letters  %}
                            <tr>
                                <td style="width: 8%;">{{i.date_of_reply | date:'d-m-Y' }}</td>
                                <td style="width: 50%;">{{i.remarks}}</td>
                                <td style="width: 2%;"><i class="fa fa-paperclip" aria-hidden="true"></i></td>  
                            </tr>
                          {% endfor %}
                          {% endif %} -->
                        </tbody>
                    </table>   
                </div>
            </div>      

          </div>
        </div>
     </div> 
    </div>

    <script>
     
    function open_do(id){
        console.log(id);
        data={
          'id':id
        }
        $.ajax
        ({
            url: "{% url 'view_ajax' %}",
            method: "GET",
            dataType: "JSON",
            async: false,
            data: data,
            success: function (response) 
            {
              letter_no=response.do_letter_no;
              $('#letter_no').val(letter_no);
              letter_date=response.do_letter_date;
              $('#letter_date').val(letter_date);
              subject=response.subject;
              $('#subject').val(subject);
              file="/media/"+response.do_file;
              $('#preview').attr('src', file);
              //document.getElementById('preview').src=url;
              table_data='';
              table_data+='<tr><td>'+response.reply_date+'</td>';              
              table_data+='<td>'+response.remarks+'</td>'; 
              table_data+='<td>'+response.attachment+'</td></tr>';   
              $('#modal_table tbody').empty()
              $('#modal_table tbody').append(table_data)
            }
        });
      }
      $(document).ready( function () {
        
        $('#table_id').DataTable();
        $('#modal_table').DataTable();
    } );

     
   
    </script>
    </body>
    

{% endblock %}