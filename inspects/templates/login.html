<!DOCTYPE html>
<html lang="en">
{% load static %}


<head>
    
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% include 'inspects_staticProvider.html' %}
    <title>Log In</title>
    
    <script type="text/javascript">
        if(self===top){
          var antiClickjack = document.getElementById("antiClickjack");
          antiClickjack.parentNode.removeChild(antiClickjack);
        }
        else{
          top.location= self.location;
        }
      </script>

    <style>
        /* new changes in login */
        .lbl-caption
{
    font-weight:600;
    font-size:12px;
    color:#4d4d4d;
}
/* CSS */
.button-5 {
  align-items: center;
  background-clip: padding-box;
  background-color: #fa6400;
  border: 1px solid transparent;
  border-radius: .25rem;
  box-shadow: rgba(0, 0, 0, 0.02) 0 1px 3px 0;
  box-sizing: border-box;
  color: #fff;
  cursor: pointer;
  display: inline-flex;
  font-family: system-ui,-apple-system,system-ui,"Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size: 16px;
  font-weight: 600;
  justify-content: center;
  line-height: 1.25;
  margin: 0;
  min-height: 3rem;
  padding: calc(.875rem - 1px) calc(1.5rem - 1px);
  position: relative;
  text-decoration: none;
  transition: all 250ms;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  vertical-align: baseline;
  width: auto;
}

.button-5:hover,
.button-5:focus {
  background-color: #fb8332;
  box-shadow: rgba(0, 0, 0, 0.1) 0 4px 12px;
}

.button-5:hover {
  transform: translateY(-1px);
}

.button-5:active {
  background-color: #c85000;
  box-shadow: rgba(0, 0, 0, .06) 0 2px 4px;
  transform: translateY(0);
}
.login-link
{
    font-weight:600;
}

    </style>

    <style>
        @media screen and (min-width:500px) {
            .myFormCard {
                background-color: #fff;
                border: 1px solid rgb(236, 236, 236);
                padding: 3%;
                margin-top: 6%;
                /* margin: 3%; */
                margin-left: 30%;
                margin-right: 30%;
                border-radius: 10px;
            }

            .myFormCard {
                /* Add shadows to create the "card" effect */
                box-shadow: 0 8px 12px 0 rgba(141, 141, 141, 0.5);
                transition: 0.3s;
            }

            /* On mouse-over, add a deeper shadow */
            .myFormCard:hover {
                box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.5);
            }


        }

        @media screen and (max-width:500px) {
            .myFormCard {
                padding: 10px;
                margin: 10px;
                box-sizing: border-box;
            }
        }
        .crislogo
        {
	    position:absolute;
	    right:40px;
	    top:40px;
	    z-index:9999;
        }
        .my-heading {
            font-family:Georgia;
            margin-top:1rem;
            font-weight : 500;
            font-size : 2.5rem;
            text-align : center;
            Color : black;
            font-weight: bold; 
        }

        .flex-container {
            display: flex;
            /* justify-content: space-between; */
        }

        .left-part {
            width: 30%;
            align-self: center;
        }

        .right-part {
            width: 60%;
            align-self: center;
        }
        html,body
{ 
    /* background-color: #039be5; */
  /* background-image: url('/static/images/pic7.jpg') no-repeat center center fixed; 
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover; */
  background: url(/static/images/bg.jpg) no-repeat center center fixed;
  background-repeat: no-repeat;
  background-size: cover;
  

}


    </style>

</head>

    <script>
        function goBack() {
          window.history.back();
        }
    </script>

<body onload="createCaptcha()">
    <div class="demo form-bg">
    <img src="/static/images/crislogo.png" class="img crislogo hidden-sm hidden-xs" />
    <div class="myFormCard">
        <div class="flex-container">
            
            <div class="left-part">
                      
                <img src="{% static 'inspects/images/logo_inspection.png' %}" alt="Logo Inspection" width="60%" height="60%">
            </div>
            <div class="my-heading right-part">

                    <!-- <span style="color: #4285f4;"></span> -->
                    <span style="color: hwb(226 21% 3%);">INSPECTION</span>                   
                    <span style="color: #34a853"></span>
                    <span style="color: #fbbc05"></span>
               
                <h3>Sign in</h3>
            </div>
        </div>
        <br>
        {% if messages %}
        {% for message in messages %}
        {% if message.tags == 'error' %}
        <p class="alert alert-danger" style="padding:5px;">{{message}}</p>
        {% elif message.tags == 'success' %}
        <p class="alert alert-success" style="padding:5px;">{{message}}</p>
        {% endif %}
        {% endfor %}
        {% endif %}
        <form method="POST">{% csrf_token %}

            <div class="row">
                <div class="col-sm">
                    <label for="email" class="lbl-caption">UserName</label>
                    <input type="text" id="email" name="email" class="form-control" maxlength="254" placeholder="UserName" required>
                </div>
            </div>

            <!-- <div class="row">
                <div class="col-sm">
                    <label for="password">Password</label><br>
                    <input type="password" id="password" name="password" class="form-control" maxlength="30"
                        placeholder="Password" onchange="trimTextField(this);" required
                        style="width: 90%;display: inline-block;"><i class="fa fa-eye"
                        style="width: 10%; display: inline-block;" id="togglePassword" onclick="seePassword(this);"></i>
                    <a href="{% url 'forgotPassword' %}">Forgot Password?</a>
                </div>
            </div> -->
            <div class="row">
                <div class="col-sm">
                    <label for="password" class="lbl-caption">Password</label><br>
                    <div class="input-group mb-3">
                        <input type="password" id="password" name="password" class="form-control" maxlength="30"
                        placeholder="Password" onchange="trimTextField(this);" required>                        
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="fa fa-eye" id="togglePassword" onclick="seePassword(this);"></i></span>
                          </div>
                      </div>
                    
                    <a href="{% url 'forgotPassword' %}"  class="login-link">Forgot Password?</a>
                </div>
            </div>
            <!-- new changes above -->
            <br>
            <div class="captcha-area">
                <div class="captcha-img">
  
                    
<!-- 	      			<i class="fas fa-redo iconn" style="color:black; margin-left:180px;" onclick="createCaptcha()"></i> -->
                     <img src="\static\rkvy\images\refresh_icon.png" style="color:black; margin-left:150px;width:40px;height:30px;" onclick="createCaptcha()">
                    <div id="captcha" style="margin-top:-40px;margin-left:20px;margin-bottom:auto;"><canvas id="captcha" width="105" height="50"></canvas></div>  
              </div>
    
            </div>
            <input type="text" class="form-control" placeholder="Enter captcha shown above" id="cpatchaTextBox" autocomplete="off">
            <p id="error" style="font-size: 20; color: #b32400;font-weight: 600;"></p>
            
            <div class="row">
                <div class="col-sm">

                    <!-- <input type="submit" id="submit" name="submit" value="Log In" onclick="return validateCaptcha()" class="btn btn-success"> -->
                    <!-- new login button -->
                    <input class="button-5" type="submit" id="submit" name="submit" value="Log In" onclick="return validateCaptcha()" >
                    <span style="margin-left:2%;" hidden>Don't have an account? <a
                            href="{% url 'signup' %}" hidden>Signup</a></span>
                            <br>
                            <a href="{% url 'nonrly_signup' %}" class="login-link">Non Railway User - Signup</a>
                            <br>
                            <a href="https://sso.indianrailways.gov.in/sso/home/userLogin.do" target="blank" class="login-link">IR SSO- Indian Railways Single Sign On - Login</a>
                    <!-- <input type="reset" id="reset" name="reset" value="Reset" class="btn btn-warning"> -->
                    <!-- <input class="btn btn-success" style="float: right;" type="button" id="submit" name="submit" value="Log In with E-pramaan" onclick="function_authenticate()"> -->
                </div>
            </div>
        </form>
        <br>
        
        <a href="/media/document/Help E-Inspection.pdf" target="blank" class="login-link">Guidelines for using e-inspection.</a>
        {%if is_sso == 'Y'%} 
        <button type="button" title="Back to SSO" class="btn btn-warning" id="back_btnhr"><b>Back to SSO</b></button>
        {%endif%}
        
        <input type="text" name="hrmsId" id="hrmsId" value="{{hrmsId | safe}}"  hidden  >
        <input type="text" name="SSOUid" id="SSOUid" value="{{SSOUid | safe}}"  hidden  >
        <input type="text" name="sessionid" id="sessionid" value="{{sessionid | safe}}"  hidden  >
        <input type="text" name="op11" id="op11" value="getbacktokenr"  hidden  >
        <form method="post" action="https://sso.indianrailways.gov.in/sso/home/userLogin.do">
                                    
            <input type="text" name="encData" id="encData" value="{{encData | safe}}" hidden >
            <input type="text" name="activity" id="activity" value="REDIRECT" hidden >
            <input type="submit" id="gobacksso" hidden>
        </form>

        
    </div>
    </div>
    <script>
        $('#back_btnhr').click(function(){
              funcsso();

          });
        function funcsso()
            {
              var hrmsid=$('#hrmsId').val()
              var op=$('#op11').val() 
              var SSOUid=$('#SSOUid').val() 
              var sessionid=$('#sessionid').val() 
              // alert(hrmsid+'-----------'+op)
              $.ajax({
                url: '{% url "einspectionhrmslogin" %}',
                method: 'POST',
                type: 'json',
                data: {hrmsid,op,SSOUid,sessionid},
                success: function(response){ 
                  // alert(response.encData+'---------'+response.ssouid)
                  $('#encData').val(response.encData)
                  
                  $('#gobacksso').click();
                  
                  }
                })  
            }
        function function_authenticate()
        {
            window.location.href="{% url 'user_authenticate' %}"
        }
        function createCaptcha() {
	  //clear the contents of captcha div first 
	  document.getElementById('captcha').innerHTML = "";
	  var charsArray =
	  "123456789ABCDEFGHJKLMNPQRSTUVWXYZ";
	  var lengthOtp = 6;
	  var captcha = [];
	  for (var i = 0; i < lengthOtp; i++) {
	    //below code will not allow Repetition of Characters
	    var index = Math.floor(Math.random() * charsArray.length + 1); //get the next character from the array
	    if (captcha.indexOf(charsArray[index]) == -1)
	      captcha.push(charsArray[index]);
	    else i--;
	  }
	  var canv = document.createElement("canvas");
	  canv.id = "captcha";
	  canv.width = 120;
	  canv.height = 50;
	  var ctx = canv.getContext("2d");
	  ctx.font = "25px Georgia";
	  ctx.strokeText(captcha.join(""), 0, 30);
	  ctx.moveTo(0, 23);
	  ctx.lineTo(100, 20);
	  ctx.moveTo(2, 1);
	  ctx.lineTo(150, 50);
	  ctx.stroke();
	  //storing captcha so that can validate you can save it somewhere else according to your specific requirements
	  code = captcha.join("");
	  document.getElementById("captcha").appendChild(canv); // adds the canvas to the body element
	}
	
function validateCaptcha() {
   
	 
	 if(document.getElementById("cpatchaTextBox").value!='')
	 {

	  if (document.getElementById("cpatchaTextBox").value == code) {
		
	    document.getElementById("error").innerHTML="";
 
	return true;
	  }
	  else {
	document.getElementById("error").innerHTML="Invalid Captcha ,Please Read it Carefully." ;

	    createCaptcha();
	    return false;
	    
	    
	  }
	  }
	  else
	  {
		document.getElementById("error").innerHTML="<br/>"+"Kindly enter captcha " ;
		createCaptcha();
	    return false;
	}
 
	}
    </script>

    

    <script>
        function trimTextField(el) {
            el.value = String(el.value).trim();
        }

        function abc() {
            console.log("in click")
        }

        const password = document.querySelector('#password');

        function seePassword(el) {
            // toggle the type attribute
            const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
            password.setAttribute('type', type);
            // toggle the eye slash icon
            const clas = el.classList.contains("fa-eye");
            if (clas) {
                el.classList.add("fa-eye-slash")
                el.classList.remove("fa-eye");
            } else {
                el.classList.add("fa-eye");
                el.classList.remove("fa-eye-slash")

            }

        }
    </script>
</body>
<script>
        
        $(document).ready(function () {
    $(".button-5").on("click", function() {
        // $(this).attr("disabled", "disabled");
        $(this).attr("hidden", "hidden");
        doWork(); //this method contains your logic
    });
});


function doWork() {
    // alert("doing work");
    //actually this function will do something and when processing is done the button is enabled by removing the 'disabled' attribute
    //I use setTimeout so you can see the button can only be clicked once, and can't be clicked again while work is being done
    setTimeout('$(".button-5").removeAttr("hidden")', 15000);
}
</script>
</html>