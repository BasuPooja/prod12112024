{% extends 'base.html' %} {% block content %} {% load static %}

<style>
  .modal-lg {
    max-width: 48%;
  }
  .modal.left .modal-dialog,
  .modal.right .modal-dialog {
    position: fixed;
    margin: auto;
    width: 80%;
    height: 100%;
    -webkit-transform: translate3d(0%, 0, 0);
    -ms-transform: translate3d(0%, 0, 0);
    -o-transform: translate3d(0%, 0, 0);
    transform: translate3d(0%, 0, 0);
  }

  .modal.left .modal-content,
  .modal.right .modal-content {
    height: 100%;
    overflow-y: auto;
  }

  .modal.left .modal-body,
  .modal.right .modal-body {
    padding: 15px 15px 80px;
  }

  /*Left*/
  .modal.left.fade .modal-dialog {
    left: -320px;
    -webkit-transition: opacity 0.3s linear, left 0.3s ease-out;
    -moz-transition: opacity 0.3s linear, left 0.3s ease-out;
    -o-transition: opacity 0.3s linear, left 0.3s ease-out;
    transition: opacity 0.3s linear, left 0.3s ease-out;
  }

  .modal.left.fade.show .modal-dialog {
    left: 0;
  }

  * {
    box-sizing: border-box;
  }
  body {
    font-family: "Quicksand", sans-serif;
    height: 100%;
    margin: 0;
  }

  input[type="text"] {
    width: 100%;
    padding: 12px 20px;
    margin: 8px 0;
    display: block;
    /* border: 1.5px solid rgb(14, 12, 12); */
    border-radius: 4px;
    box-sizing: border-box;
  }

  input[type="submit"] {
    width: 40%;
    text-align: center;
    background-color: #4caf50;

    padding: 14px 20px;
    margin: 8px 0;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  input[type="submit"]:hover {
    background-color: #45a049;
    text-align: center;
  }

  input[type="button"]:hover {
    background-color: #45a049;
    text-align: center;
  }
  /* #viewbtn{
        margin-left:1050px;
      } */

  .inputtag {
    height: 20px;
  }
  .button {
    padding: 15px 25px;
    font-size: 12px;
    text-align: center;
    margin-left: 2em;
    cursor: pointer;
    outline: none;
    color: #fff;
    background-color: #04aa6d;
    border: none;
    border-radius: 15px;
  }

  .button:hover {
    background-color: #3e8e41;
  }

  .button:active {
    background-color: #3e8e41;
    box-shadow: 0 5px #666;
    transform: translateY(4px);
  }
</style>
<style>
  #viewbtn {
    margin-left: 1200px;
    margin-right: 10px;
  }

  /* Add Animation */
  @-webkit-keyframes animatetop {
    from {
      top: -300px;
      opacity: 0;
    }
    to {
      top: 0;
      opacity: 1;
    }
  }

  @keyframes animatetop {
    from {
      top: -300px;
      opacity: 0;
    }
    to {
      top: 0;
      opacity: 1;
    }
  }

  /* The Close Button */
  .close {
    color: white;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }

  .inpt-container {
    background-image: linear-gradient(#cce3fc, #ffffff);
    border-bottom: 2px solid #b0d8f5;
    margin-bottom: 1rem;
  }

  .close:hover,
  .close:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
  }
</style>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> -->
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script> -->
  <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script> -->
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.1/js/bootstrap.min.js"
    integrity="sha512-EKWWs1ZcA2ZY9lbLISPz8aGR2+L7JVYqBAYTq5AXgBkSjRSuQEGqWx8R1zAX16KdXPaCjOCaKE8MCpU0wcHlHA=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  ></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.1/css/bootstrap-grid.min.css"
    integrity="sha512-Aa+z1qgIG+Hv4H2W3EMl3btnnwTQRA47ZiSecYSkWavHUkBF2aPOIIvlvjLCsjapW1IfsGrEO3FU693ReouVTA=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

  <link
    rel="stylesheet"
    type="text/css"
    media="screen"
    href="{% static '/css/forms_common.css' %}"
  />
  <link
    rel="stylesheet"
    type="text/css"
    media="screen"
    href="{% static '/css/forms_common.css' %}"
  />
  <link
    rel="stylesheet"
    type="text/css"
    href="{% static '/css/datatables/jquery.dataTables.min.css' %}"
  />
  <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.flash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
  <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"></script>
  <link
    rel="stylesheet"
    type="text/css"
    href="https://cdn.datatables.net/1.13.3/css/jquery.dataTables.min.css"
  />
  <link
    rel="stylesheet"
    type="text/css"
    href="https://cdn.datatables.net/buttons/2.3.5/css/buttons.dataTables.min.css"
  />
</head>
<style>
  table.dataTable tfoot th,
  table.dataTable tfoot td {
    /* padding: 10px 18px; */
    border-bottom: none;
  }
  .loader {
    display: none;
    position: sticky;
    left: 45%;
    top: 45%;
    border: 16px solid #f3f3f3;
    border-radius: 50%;
    border-top: 16px solid #3498db;
    width: 120px;
    height: 120px;
    z-index: 999;
    --webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
  }
  @-webkit-keyframes spin {
    0% {
      -webkit-transform: rotate(0deg);
    }
    100% {
      -webkit-transform: rotate(360deg);
    }
  }
  @keyframes spin {
    0% {
      -webkit-transform: rotate(0deg);
    }
    100% {
      -webkit-transform: rotate(360deg);
    }
  }
  
</style>

<h3 class="report_heading">Inspection Report Officer Wise</h3>
<div class="loader"></div>
<br />
<div class="container">
  <div class="inpt-container" id="container1">
    <form action="{% url 'search_location' %}" method="POST" id="indexForm">
      {% csrf_token %}

      <div class="row" style="margin-left: 1em; margin-right: 5em">
        <div class="col-2 form-group">
          <label for="rly_id" class="lbl-caption">Rly./Org. Wise</label>
          <select
            class="form-control self-control"
            id="location_code"
            name="location_code"
            class="custom-select"
            data-placeholder="Rly/Org..."
            multiple
            required
          >
            <option value="" disabled hidden>All</option>
            {% for z in zone %}
            <option value="{{z}}">{{z}}</option>
            {% endfor %}
          </select>
        </div>

        <div class="col-2 form-group">
          <label for="div_id" class="lbl-caption">Div./Unit Wise</label>

          <select
            class="form-control self-control"
            id="location_type"
            name="location_type"
            class="custom-select"
            data-placeholder="Div/Unit..."
            multiple
          >
            <option value="" disabled hidden>All</option>
            {% for d in division %}
            <option value="{{d.location_code}}-{{d.location_type}}">
              {{d.location_code}}-{{d.location_type}}
            </option>

            {% endfor %}
          </select>
        </div>

        <div class="col-2 form-group" hidden>
          <label for="department_name" class="lbl-caption">Department</label>
          <select
            class="form-control sel-control"
            id="dept"
            name="dept"
            class="custom-select"
            data-placeholder="Department..."
            multiple
            hidden
          >
            <option value="" disabled hidden>select</option>
            {% for d in dept %}
            <option value="{{d}}">{{d}}</option>
            {% endfor %}
          </select>
        </div>

        <div class="col-2 form-group">
          <label for="designation" class="lbl-caption">Designation Wise</label>
          <select
            class="form-control sel-control"
            id="designation"
            name="designation"
            class="custom-select"
            multiple
            data-placeholder="Designation..."
          >
            <option value="" disabled hidden>select</option>
            {% for d in desi %}
            <option value="{{d}}">{{d}}</option>
            {% endfor %}
          </select>
        </div>

        <div class="col-2 form-group">
          <label for="date" class="lbl-caption">Date Range</label>
          <input
            class="form-control"
            id="created_on"
            name="created_on"
            value="{{new_date}}"
            autocomplete="off"
            placeholder="Select Daterange"
            style="margin-top: 0em; background-color: #fff"
            readonly
          />
        </div>

        <div class="col-2">
          <div class="btn-toolbar" role="toolbar">
            <div class="btn-group" role="group">
              <button
                type="button"
                onclick="MarkedByOfficer()"
                style="margin-top: 30%"
                class="btn btn-warning btn-sm"
                id="search_ob"
              >
                Continue
              </button>

              <a
                class="btn btn-secondary btn-sm"
                href="/search_location/"
                style="margin-top: 30%"
                >Reset</a
              >
            </div>
          </div>
          <br />
        </div>
      </div>
    </form>
  </div>
</div>
<br />

<!-- NAV BAR -->
<div class="container">
  <div class="row" id="1" style="overflow-x: auto">
    <form method="POST" id="indexForm">
      {% csrf_token %}
      <div id="tablediv1" class="box-body no-padding">
        <table
          id="tableid1"
          name="tableid1"
          class="table table-entry table-bordered"
          cellspacing="0"
          style="width: 100%;"
        >
          <thead
            style="color: white; background-color: #1e90ff; text-align: left"
          >
            <tr>
              <th width = '2px'>Officer Desig</th>
              <th width = '2px'>Created Notes</th>
              <th width = '2px'>Pending Compliance Created Notes</th>
              <th width = '2px'>% compliance created Notes</th>
              <th width = '2px'>Marked Notes</th>
              <th width = '2px'>Marked Pending compliance</th>
              <th width = '2px'>% Compliance Marked Notes</th>
              <th width = '2px'>MOM Created</th>
              <th width = '2px'>MOM Pending compliance</th>
              <th width = '2px'>% compliance MOM Notes</th>
              <th width = '2px'>MOM Marked</th>
              <th width = '2px'>MOM Marked Pending compliance</th>
              <th width = '2px'>% Compliance MOM Marked Notes</th>
              <th width = '2px'>DO Created</th>
              <th width = '2px'>DO Pending compliance</th>
              <th width = '2px'>% DO compliance</th>
              <th width = '2px'>DO Marked</th>
              <th width = '2px'>DO Marked Pending compliance</th>
              <th width = '2px'>% Compliance DO Marked</th>
              <th width = '2px'>Task Created</th>
              <th width = '2px'>Task Pending Compliance</th>
              <th width = '2px'>Task Assigned</th>
              <th width = '2px'>Task Assigned Pending compliance</th>
            </tr>
          </thead>

          <tbody></tbody>
          <tfoot></tfoot>
        </table>
      </div>
    </form>
  </div>
</div>

<script>
  $(document).ready(function () {
    $("#location_code").select2();
  });
  $(document).ready(function () {
    $("#location_type").select2();
  });
  $(document).ready(function () {
    $("#dept").select2();
  });
  $(document).ready(function () {
    $("#designation").select2();
  });
  $(document).ready(function () {
    $("#status").select2();
  });

  $(function () {
    $('input[name="created_on"]').daterangepicker({
      autoUpdateInput: false,
      autoApply: true,
      maxDate: new Date(),
      opens: "left",
      locale: {
        cancelLabel: "Clear",
      },
    });

    $('input[name="created_on"]').on(
      "apply.daterangepicker",
      function (ev, picker) {
        $(this).val(
          picker.startDate.format("DD/MM/YY") +
            " to " +
            picker.endDate.format("DD/MM/YY")
        );

        if (
          picker.startDate.format("DD/MM/YY") ==
          picker.endDate.format("DD/MM/YY")
        ) {
          $(this).val(picker.startDate.format("DD/MM/YY"));
        } else {
          $(this).val(
            picker.startDate.format("DD/MM/YY") +
              " to " +
              picker.endDate.format("DD/MM/YY")
          );
        }

        $(".applyButtonClasses").click();
      }
    );

    $('input[name="created_on"]').on(
      "cancel.daterangepicker",
      function (ev, picker) {
        $(this).val("");
      }
    );
  });

  $("#location_type").change(function () {
    var groupss = $("#location_type").val();
    data = {
      groupss: JSON.stringify(groupss),
    };
    $.ajax({
      type: "GET",
      url: "{% url 'search_desig_ajax1' %}",
      dataType: "json",
      data: data,

      success: function (response) {
        //alert("hereeee")
        console.log("0000000000", response);
        $("#designation").find("option").remove();
        $("#designation").append();
        //$("#designation").find('option').remove();
        for (i = 0; i < response.ins.length; i++) {
          $("#designation").append(
            `<option value="${response.ins[i]}">${response.ins[i]}</option>`
          );
        }
      },
    });
  });

  function location_change_add() {
    //alert('hellkkkk')
    var root = $("#location_type").val();
    data = {
      root: JSON.stringify(root),
    };
    $.ajax({
      type: "GET",
      url: "{% url 'search_des_loc_ajax' %}",
      dataType: "json",
      data: data,
      success: function (response) {
        //alert("hereeee")
        console.log("0000000000", response);
        $("#location_code").find("option").remove();
        $("#location_code").append();
        for (i in response.ins) {
          $("#location_code").append(
            `<option selected value="${response.ins[i]}">${response.ins[i]}</option>`
          );
        }
      },
    });
  }

  $("#location_code").change(function () {
    var group = $("#location_code").val();
    // alert(group)
    //alert("heree")
    data = {
      group: JSON.stringify(group),
    };
    $.ajax({
      type: "GET",
      url: "{% url 'search_locat_ajax1' %}",
      dataType: "json",
      data: data,
      success: function (response) {
        $("#location_type").select2("destroy");
        $("#designation").select2("destroy");
        $("#location_type option").remove();

        // $("#location_type").find("option").remove();

        let option = ``;
        for (i = 0; i < response.ins.length; i++) {
          option += `<option value="${response.ins[i]["location_code"]}-${response.ins[i]["location_type"]}" >${response.ins[i]["location_code"]}-${response.ins[i]["location_type"]}</option>`;
        }
        $("#location_type").append(option);

        let option1 = ``;
        $("#designation option").remove();

        for (i = 0; i < response.insdesig.length; i++) {
          option1 += `<option value="${response.insdesig[i]}">${response.insdesig[i]}</option>`;
        }
        $("#designation").append(option1);
        $("#location_type").select2();
        $("#designation").select2();
      },
    });
  });

  //show data in

  $("#tablediv").hide();
  $("#tabledivs").hide();

  var table = $("#tableid1").DataTable({
    iDisplayLength: 15,
    // "ordering": false,
    order: [[1, "desc"]],
    lengthChange: true,
    lengthMenu: [15, 30, 50, 75, 100],
    dom: "Blfrtip",
    orientation:'LEGAL',
    buttons: [
      {
        extend: "excel",
        title: function (e) {
          let date2 = $("#created_on").val();
          var stre = "Inspection Report from " + date2;
          return stre;
        },
        // orientation: 'landscape',
        // pageSize: 'LEGAL',
      },
      {
        extend: "pdfHtml5",
        title: function (e) {
          var e1 = $("#datefrom").val();
          var e2 = $("#dateto").val();
          console.log("datefrom1", e1);
          console.log("datefrom1", datefrom);
          var stre = "Inspection Report from " + e1 + " to " + e2;
          console.log("insode inspection report", stre);
          return stre;
        },
        
        exportOptions: {
          alignment: "right",
        },
        customize: function (doc) {
          console.log("doc", doc);
          console.log("doc", doc.defaultStyle);
          console.log("doc2", doc.styles.tableBodyEven);
          console.log("doc3", doc.styles.tableBodyOdd);
          doc.content.splice(0, 1);

          doc.styles.tableBodyEven.alignment = "center";
          doc.styles.tableBodyOdd.alignment = "center";
        },
        text: "Pdf",
        title: "Inspection Report ",
        fontSize: "LEGAL",
      },
      {
        extend: "print",
        footer: true,
        title: function (e) {
          var s1 = $("#datefrom").val();
          var s2 = $("#dateto").val();
          let date2 = $("#created_on").val();
          var str = "Inspection Report from " + date2;
          return str;
        },
        fontSize: "LEGAL",
        orientation:'landscape',
        customize: function (doc) {
          $(doc.document.body).find("tableid1").css("text-align", "center");
          // $(doc.document.body).find("tableid1").css("transform", "rotate(90deg)");

        },
        pagingType: "simple",
        sEmptyTable: "No data available in table",

        // "bSort": true,

        oLanguage: {
          sInfoEmpty: "Page 0 of 0 ",
        },
        language: {
          info: "Page _PAGE_ of _PAGES_",
          paginate: {
            previous: "Prev",
          },
        },
      },
    ],
  });
</script>

<script>
  // saud faisal

  function MarkedByOfficer() {
    let ajaxname = "MarkedByOfficer";
    count = 0;
    var location_code = $("#location_code").val();
    var location_type = $("#location_type").val();
    var designation = $("#designation").val();
    var dept = $("#dept").val();
    var created_on = $("#created_on").val();
    var status = $("#status").val();
    var query = $("#query").val();
    //alert(query)
    $(".loader").show();
    $.ajax({
      url: "{% url 'fetch_desig_ajax_officerwise_all_marked' %}",
      method: "GET",
      dataType: "JSON",
      data: {
        ajaxname: ajaxname,
        location_code: JSON.stringify(location_code),
        location_type: JSON.stringify(location_type),
        designation: JSON.stringify(designation),
        dept: JSON.stringify(dept),
        created_on: created_on,
      },
      async: false,
      success: function (response) {
        table.destroy();

        console.log("response67788", response);
        $("#tableid1 tbody").empty();
        $("#tableid1 tfoot").empty();

        let myhtml2 = "";

        for (i = 0; i < response.rly_list.length; i++) {
          myhtml2 += "<tr>";
          myhtml2 += " <td>" + response.rly_list[i]["rly"] + "</td>";
          myhtml2 +=
            " <td>" +
            response.rly_list[i]["created_insp_notes"] +
            "/" +
            response.rly_list[i]["created_insp_para"] +
            "</td>";
          myhtml2 +=
            " <td>" +
            response.rly_list[i]["pending_insp_notes"] +
            "/" +
            response.rly_list[i]["pending_insp_para"] +
            "</td>";
          myhtml2 +=
            " <td>" +
            response.rly_list[i]["per_created_insp_notes"].toFixed(2) +
            "/" +
            response.rly_list[i]["per_created_insp_notes"].toFixed(2) +
            "</td>";
          myhtml2 +=
            " <td>" +
            response.rly_list[i]["marked_created_insp_notes"] +
            "/" +
            response.rly_list[i]["marked_created_insp_para"] +
            "</td>";
          myhtml2 +=
            " <td>" +
            response.rly_list[i]["marked_pending_insp_notes"] +
            "/" +
            response.rly_list[i]["marked_pending_insp_para"] +
            "</td>";
          myhtml2 +=
            " <td>" +
            response.rly_list[i]["per_marked_created_insp_notes"].toFixed(2) +
            "/" +
            response.rly_list[i]["per_marked_created_insp_para"].toFixed(2) +
            "</td>";

          myhtml2 +=
            " <td>" +
            response.rly_list[i]["mom_created_insp_notes"] +
            "/" +
            response.rly_list[i]["mom_created_insp_para"] +
            "</td>";

          myhtml2 +=
            " <td>" +
            response.rly_list[i]["mom_pending_insp_notes"] +
            "/" +
            response.rly_list[i]["mom_pending_insp_para"] +
            "</td>";
          myhtml2 +=
            " <td>" +
            response.rly_list[i]["per_mom_created_insp_notes"].toFixed(2) +
            "/" +
            response.rly_list[i]["per_mom_pending_insp_notes"].toFixed(2) +
            "</td>";
          myhtml2 +=
            " <td>" +
            response.rly_list[i]["marked_mom_created_insp_notes"] +
            "/" +
            response.rly_list[i]["marked_mom_created_insp_para"] +
            "</td>";

          myhtml2 +=
            " <td>" +
            response.rly_list[i]["marked_mom_pending_insp_notes"] +
            "/" +
            response.rly_list[i]["marked_mom_pending_insp_para"];
          ("</td>");

          myhtml2 +=
            " <td>" +
            response.rly_list[i]["per_marked_mom_created"].toFixed(2) +
            "/" +
            response.rly_list[i]["per_marked_mom_pending"].toFixed(2) +
            "</td>";
          // do letter data
          myhtml2 += " <td>" + response.rly_list[i]["do_total_open"] + "</td>";
          myhtml2 +=
            " <td>" + response.rly_list[i]["do_total_pending"] + "</td>";
          myhtml2 +=
            " <td>" + response.rly_list[i]["do_per_complied"].toFixed(2) + "</td>";
          myhtml2 +=
            " <td>" + response.rly_list[i]["mark_do_total_open"] + "</td>";
          myhtml2 +=
            " <td>" + response.rly_list[i]["mark_do_total_pending"] + "</td>";
          myhtml2 +=
            " <td>" + response.rly_list[i]["mark_do_per_complied"].toFixed(2) + "</td>";
          // task tracker data
          myhtml2 += " <td>" + response.rly_list[i]["task_assigned"] + "</td>";
          myhtml2 += " <td>" + response.rly_list[i]["task_completed"] + "</td>";
          myhtml2 +=
            " <td>" + response.rly_list[i]["mark_task_assigned"] + "</td>";
          myhtml2 +=
            " <td>" + response.rly_list[i]["mark_task_completed"] + "</td>";
          myhtml2 += "</tr>";
        }

        mommyhtml3 = "<tr>";
        mommyhtml3 += "<td>" + "Total" + "</td>";
        mommyhtml3 += "<td>" + response.mom_total_total_inspection + "</td>";
        mommyhtml3 += "<td>" + response.mom_total_total_closed + "</td>";
        mommyhtml3 += "<td>" + response.mom_total_total_open + "</td>";
        mommyhtml3 += "<td>" + response.mom_total_total_item + "</td>";
        mommyhtml3 += "<td>" + response.mom_total_total_item_pending + "</td>";
        mommyhtml3 += "<td>" + response.mom_total_total_item_overdue + "</td>";
        mommyhtml3 += "<td>" + response.mom_total_total_per_complied + "</td>";
        mommyhtml3 += "</tr>";

        myhtml3 = "<tr>";
        myhtml3 += "<td>" + "Total" + "</td>";
        myhtml3 += "<td>" + response.total_total_inspection + "</td>";
        myhtml3 += "<td>" + response.total_total_closed + "</td>";
        myhtml3 += "<td>" + response.total_total_open + "</td>";
        myhtml3 += "<td>" + response.total_total_item + "</td>";
        myhtml3 += "<td>" + response.total_total_item_pending + "</td>";
        myhtml3 += "<td>" + response.total_total_item_overdue + "</td>";
        myhtml3 += "<td>" + response.total_total_per_complied + "</td>";
        myhtml3 += "</tr>";

        domyhtml3 = "<tr>";
        domyhtml3 += "<td>" + "Total" + "</td>";
        domyhtml3 += "<td>" + response.do_total_total_open + "</td>";
        domyhtml3 += "<td>" + response.do_total_total_pending + "</td>";
        domyhtml3 += "<td>" + response.do_total_total_closed + "</td>";
        domyhtml3 += "<td>" + response.do_total_total_per_complied + "</td>";
        domyhtml3 += "</tr>";

        trackmyhtml3 = "<tr>";
        trackmyhtml3 += "<td>" + "Total" + "</td>";
        trackmyhtml3 += "<td>" + response.task_total_total_open + "</td>";
        trackmyhtml3 += "<td>" + response.total_total_task_assign + "</td>";
        trackmyhtml3 += "<td>" + response.total_total_task_completed + "</td>";
        trackmyhtml3 +=
          "<td>" + response.task_total_total_per_complied + "</td>";
        trackmyhtml3 += "</tr>";

        $("#tableid1 tbody").append(myhtml2);
        // $("#tableid1 tfoot").append(myhtml3);

        $("#tablediv").show();
        $(".loader").hide();

        table = $("#tableid1").DataTable({
          iDisplayLength: 15,
          // "ordering": false,
          order: [[1, "desc"]],
          lengthChange: true,
          lengthMenu: [15, 30, 50, 75, 100],
          dom: "Blfrtip",

          buttons: [
            {
              extend: "excel",
              title: function (e) {
                var e1 = $("#datefrom").val();
                console.log("datefrom", e1);
                var e2 = $("#dateto").val();
                var stre = "Inspection Report from " + e1 + " to " + e2;
                return stre;
              },
              // orientation: 'landscape',
              // pageSize: 'LEGAL',
            },
            {
              extend: "pdfHtml5",
              title: function (e) {
                var e1 = $("#datefrom").val();
                var e2 = $("#dateto").val();
                console.log("datefrom1", e1);
                console.log("datefrom1", datefrom);
                var stre = "Inspection Report from " + e1 + " to " + e2;
                console.log("insode inspection report", stre);
                return stre;
              },
              exportOptions: {
                alignment: "right",
              },
              customize: function (doc) {
                console.log("doc", doc);
                console.log("doc", doc.defaultStyle);
                console.log("doc2", doc.styles.tableBodyEven);
                console.log("doc3", doc.styles.tableBodyOdd);
                doc.content.splice(0, 1);

                doc.styles.tableBodyEven.alignment = "center";
                doc.styles.tableBodyOdd.alignment = "center";
              },
              text: "Pdf",
              title: "Inspection Report ",
              fontSize: "LEGAL",
            },
            {
              extend: "print",
              footer: true,
              title: function (e) {
                var s1 = $("#datefrom").val();
                var s2 = $("#dateto").val();
                let date2 = $("#created_on").val();
                var str = "Inspection Report from " + date2;
                return str;
              },
              customize: function (doc) {
                $(doc.document.body)
                  .find("tableid")
                  .css("text-align", "center");

                //  $(doc.document.body).find('table').css('border', '1px solid #000');
                //  $(doc.document.body).find('table td').css('border-left', '1px solid #000');
                //  $(doc.document.body).find('table td').css('border-top', '1px solid #000');
                //  $(doc.document.body).find('table td').css('border-right', '1px solid #000');
                //  $(doc.document.body).find('table td').css('border-bottom', '1px solid #000');
              },
              pagingType: "simple",
              sEmptyTable: "No data available in table",

              // "bSort": true,

              oLanguage: {
                sInfoEmpty: "Page 0 of 0 ",
              },
              language: {
                info: "Page _PAGE_ of _PAGES_",
                paginate: {
                  previous: "Prev",
                },
              },
            },
          ],
        });
      },
    });
  }
</script>

{% endblock %}
